### Pose Estimation / Landmark Detection Loss Functions (Including Multiperson)

| Loss Function                 | Purpose | Formula | Key Points |
|-------------------------------|---------|---------|------------|
| **Mean Squared Error (MSE)** | Measures the average squared distance between predicted and actual landmark positions | **$\mathcal{L}_{\text{MSE}} = \frac{1}{N} \sum_{i=1}^{N} \left( \text{Actual}_i - \hat{\text{Pose}}_i \right)^2$** <br><br> *where:* <br> $\text{Actual}_i$: True landmark position <br> $\hat{\text{Pose}}_i$: Predicted landmark position | - **Pros:** Simple and effective for training <br> - **Cons:** Sensitive to outliers; may not capture fine details of complex poses |
| **Mean Absolute Error (MAE)** | Measures the average absolute difference between predicted and actual landmark positions | **$\mathcal{L}_{\text{MAE}} = \frac{1}{N} \sum_{i=1}^{N} \left\| \text{Actual}_i - \hat{\text{Pose}}_i \right\|$** <br><br> *where:* <br> $\text{Actual}_i$: True landmark position <br> $\hat{\text{Pose}}_i$: Predicted landmark position | - **Pros:** Robust to outliers compared to MSE <br> - **Cons:** May be less sensitive to small errors |
| **Huber Loss** | Combines the robustness of MAE with the sensitivity of MSE | **$\mathcal{L}_{\text{Huber}} = \begin{cases} \frac{1}{2} ( \text{Actual}_i - \hat{\text{Pose}}_i )^2 & \text{if } \|\text{Actual}_i - \hat{\text{Pose}}_i\| \leq \delta \\ \delta \cdot \left\| \text{Actual}_i - \hat{\text{Pose}}_i \right\| - \frac{1}{2} \delta^2 & \text{otherwise} \end{cases}$** <br><br> *where:* <br> $\delta$: Threshold parameter <br> $\text{Actual}_i$: True landmark position <br> $\hat{\text{Pose}}_i$: Predicted landmark position | - **Pros:** Balances sensitivity to errors and robustness to outliers <br> - **Cons:** Requires careful tuning of $\delta$ |
| **PCK Loss (Percentage of Correct Keypoints)** | Measures the percentage of keypoints within a certain distance from the true location | **$\text{PCK} = \frac{1}{N} \sum_{i=1}^{N} \mathbb{1}\left(\frac{\left\| \text{Actual}_i - \hat{\text{Pose}}_i \right\|}{\text{Scale}} \leq \alpha \right)$** <br><br> *where:* <br> $\mathbb{1}$: Indicator function <br> $\text{Scale}$: Object scale (e.g., head size) <br> $\alpha$: Distance threshold | - **Pros:** Intuitive and useful for evaluating keypoint accuracy <br> - **Cons:** Requires setting an appropriate threshold $\alpha$ |
| **Geometric Loss** | Minimizes the difference in geometric properties (e.g., angles, distances) between predicted and true poses | **$\mathcal{L}_{\text{Geo}} = \frac{1}{N} \sum_{i=1}^{N} \left\| \text{Geo}_{\text{Actual}_i} - \text{Geo}_{\hat{\text{Pose}}_i} \right\|$** <br><br> *where:* <br> $\text{Geo}_{\text{Actual}_i}$: True geometric property <br> $\text{Geo}_{\hat{\text{Pose}}_i}$: Predicted geometric property | - **Pros:** Captures relative relationships between landmarks <br> - **Cons:** May be computationally intensive for complex geometries |
| **Angular Loss** | Specifically designed for 3D and 6D pose estimation, minimizes the angular difference between predicted and actual orientations | **$\mathcal{L}_{\text{Angular}} = \arccos\left(\frac{\text{Actual}_i \cdot \hat{\text{Pose}}_i}{\|\text{Actual}_i\| \|\hat{\text{Pose}}_i\|}\right)$** <br><br> *where:* <br> $\text{Actual}_i$: True orientation vector <br> $\hat{\text{Pose}}_i$: Predicted orientation vector | - **Pros:** Directly measures orientation accuracy <br> - **Cons:** Sensitive to small errors in high-dimensional spaces |
| **Symmetric Loss** | Handles symmetric objects by minimizing loss over the closest symmetric equivalent | **$\mathcal{L}_{\text{Symmetric}} = \min_{\text{Sym}_j} \|\text{Actual}_i - \hat{\text{Pose}}_i \cdot \text{Sym}_j\|$** <br><br> *where:* <br> $\text{Sym}_j$: Symmetry transformation <br> $\text{Actual}_i$: True pose <br> $\hat{\text{Pose}}_i$: Predicted pose | - **Pros:** Effective for objects with symmetries <br> - **Cons:** Computationally expensive due to the minimization process |
| **Multi-Person Joint Matching Loss** | Designed to handle multiple people in the same frame by matching predicted poses to actual poses using a global assignment strategy | **$\mathcal{L}_{\text{MPJM}} = \min_{\sigma \in \Sigma} \sum_{i=1}^{N} \text{Cost}(\text{Actual}_{\sigma(i)}, \hat{\text{Pose}}_i)$** <br><br> *where:* <br> $\Sigma$: Set of all possible permutations <br> $\sigma(i)$: Permutation index <br> $\text{Cost}$: Matching cost function | - **Pros:** Handles multiple persons in a frame; reduces assignment errors <br> - **Cons:** Computationally expensive; requires solving an assignment problem |

### Pose Estimation / Landmark Detection Metrics

| Metric                        | Estimation Type | Purpose | Formula | Key Points |
|-------------------------------|-----------------|---------|---------|------------|
| **PCK (Percentage of Correct Keypoints)** | 2D | Evaluates the accuracy of predicted keypoints within a specified threshold | **$\text{PCK} = \frac{1}{N} \sum_{i=1}^{N} \mathbb{1}\left(\frac{\left\| \text{Actual}_i - \hat{\text{Pose}}_i \right\|}{\text{Scale}} \leq \alpha \right)$** <br><br> *where:* <br> $\mathbb{1}$: Indicator function <br> $\text{Scale}$: Object scale (e.g., head size) <br> $\alpha$: Distance threshold | - **Pros:** Widely used; intuitive for 2D pose estimation <br> - **Cons:** Performance is sensitive to the choice of threshold |
| **PCKh (PCK with head size)** | 2D | A variant of PCK that uses head size as the normalization factor | **$\text{PCKh} = \frac{1}{N} \sum_{i=1}^{N} \mathbb{1}\left(\frac{\left\| \text{Actual}_i - \hat{\text{Pose}}_i \right\|}{\text{HeadSize}} \leq \alpha \right)$** <br><br> *where:* <br> $\mathbb{1}$: Indicator function <br> $\text{HeadSize}$: Head size for normalization <br> $\alpha$: Distance threshold | - **Pros:** Better suited for human pose estimation <br> - **Cons:** Requires accurate head size measurement |
| **PDJ (Percentage of Detected Joints)** | 2D | Evaluates the percentage of correctly detected joints relative to a bounding box diagonal threshold | **$\text{PDJ} = \frac{1}{N} \sum_{i=1}^{N} \mathbb{1}\left(\frac{\left\| \text{Actual}_i - \hat{\text{Pose}}_i \right\|}{\text{Diagonal}} \leq \alpha \right)$** <br><br> *where:* <br> $\text{Diagonal}$: Bounding box diagonal <br> $\alpha$: Distance threshold | - **Pros:** Adaptable to different subject sizes <br> - **Cons:** Requires calculating bounding box diagonals |
| **OKS (Object Keypoint Similarity)** | 2D | Evaluates the similarity between predicted and ground truth keypoints based on distance and scale | **$\text{OKS} = \frac{\sum_i \exp\left(-\frac{d_i^2}{2s^2k_i^2}\right) \delta(v_i > 0)}{\sum_i \delta(v_i > 0)}$** <br><br> *where:* <br> $d_i$: Distance between predicted and actual keypoint <br> $s$: Object scale <br> $k_i$: Keypoint-specific constant <br> $v_i$: Keypoint visibility | - **Pros:** Takes scale and visibility into account <br> - **Cons:** Requires carefully set constants for keypoint sensitivity |
| **MPJPE (Mean Per Joint Position Error)** | 3D | Measures the average Euclidean distance between predicted and true keypoints in 3D space | **$\text{MPJPE} = \frac{1}{N} \sum_{i=1}^{N} \left\| \text{Actual}_i - \hat{\text{Pose}}_i \right\|$** <br><br> *where:* <br> $\text{Actual}_i$: True joint position <br> $\hat{\text{Pose}}_i$: Predicted joint position | - **Pros:** Standard metric for 3D pose estimation <br> - **Cons:** Sensitive to scale differences |
| **N-MPJPE (Normalized MPJPE)** | 3D | MPJPE normalized by the scale of the pose | **$\text{N-MPJPE} = \frac{1}{N} \sum_{i=1}^{N} \frac{\left\| \text{Actual}_i - \hat{\text{Pose}}_i \right\|}{\text{Scale}}$** <br><br> *where:* <br> $\text{Actual}_i$: True joint position <br> $\hat{\text{Pose}}_i$: Predicted joint position <br> $\text{Scale}$: Pose scale | - **Pros:** Reduces the impact of varying scales <br> - **Cons:** Requires accurate scale estimation |
| **Angular Loss**               | 3D | Minimizes the angular difference between predicted and actual orientations | **$\mathcal{L}_{\text{Angular}} = \arccos\left(\frac{\text{Actual}_i \cdot \hat{\text{Pose}}_i}{\|\text{Actual}_i\| \|\hat{\text{Pose}}_i\|}\right)$** | - **Pros:** Directly measures orientation accuracy <br> - **Cons:** Sensitive to small errors in high-dimensional spaces |
| **EPE (End-Point Error)** | 6D | Measures the Euclidean distance between the predicted and true endpoint positions in 6D pose estimation | **$\text{EPE} = \frac{1}{N} \sum_{i=1}^{N} \left\| \text{Actual}_{\text{end}_i} - \hat{\text{Pose}}_{\text{end}_i} \right\|$** <br><br> *where:* <br> $\text{Actual}_{\text{end}_i}$: True endpoint position <br> $\hat{\text{Pose}}_{\text{end}_i}$: Predicted endpoint position | - **Pros:** Key metric for 6D pose accuracy <br> - **Cons:** Sensitive to noise in endpoint predictions |
| **ADD (Average Distance of Model Points)** | 6D | Measures the average distance between transformed model points using true and predicted poses | **$\text{ADD} = \frac{1}{\|P\|} \sum_{x \in P} \left\| \text{R}_{\text{Actual}} \cdot x + t_{\text{Actual}} - (\text{R}_{\hat{\text{Pose}}} \cdot x + t_{\hat{\text{Pose}}}) \right\|$** <br><br> *where:* <br> $\text{R}$: Rotation matrix <br> $t$: Translation vector <br> $P$: Set of model points | - **Pros:** Effective for 6D pose estimation; considers both rotation and translation <br> - **Cons:** Computationally intensive |
| **HOTA (Higher Order Tracking Accuracy)** | Multi-Person | Evaluates pose estimation and matching accuracy simultaneously | **$\text{HOTA} = \sqrt{\text{DetectionAccuracy} \times \text{AssociationAccuracy}}$** <br><br> *where:* <br> $\text{DetectionAccuracy}$: Accuracy of detecting poses <br> $\text{AssociationAccuracy}$: Accuracy of matching poses across frames | - **Pros:** Captures both detection and association accuracy <br> - **Cons:** Complex to compute |
| **mAP (mean Average Precision)** | Multi-Person | Measures the accuracy of keypoint detection and localization | **$\text{mAP} = \frac{1}{N} \sum_{i=1}^{N} \text{AP}(\text{keypoint}_i)$** <br><br> *where:* <br> $\text{AP}(\text{keypoint}_i)$: Average precision for keypoint $i$ | - **Pros:** Effective for multi-person detection <br> - **Cons:** Computationally intensive; requires threshold tuning |
| **mAP (Mean Average Precision) for Multi-Person** | Multi-Person | Evaluates the precision and recall of detected poses across multiple people in an image | **$\text{mAP} = \frac{1}{\|P\|} \sum_{p \in P} \frac{1}{N_p} \sum_{i=1}^{N_p} \text{AP}(\text{Pose}_{p,i})$** <br><br> *where:* <br> $P$: Set of detected persons <br> $N_p$: Number of detected keypoints for person $p$ <br> $\text{AP}(\text{Pose}_{p,i})$: Average precision for keypoint $i$ of person $p$ | - **Pros:** Widely used for multi-person pose estimation <br> - **Cons:** Requires accurate person detection and keypoint matching |
